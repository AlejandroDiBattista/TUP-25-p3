<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>LUCARBA</title>

    <link rel="stylesheet" href="style.css">

</head>
<body>
    <header>
        <span class="logo" onclick="mostrarCatalogo()">LUCARBA</span>
        <input class="buscador" id="buscador" type="text" placeholder="Buscar productos..." oninput="filtrarProductos()">
        <div class="carrito-icono" onclick="mostrarCarrito()">
            üõí <span class="carrito-contador" id="contadorCarrito">0</span>
        </div>
    </header>
    <div class="contenedor" id="vistaCatalogo"></div>
    <div class="carrito" id="vistaCarrito" style="display:none"></div>
    <div class="confirmacion" id="vistaConfirmacion" style="display:none"></div>
    <script>
        // Productos de ejemplo
        const productos = [
            { id: 1, nombre: "Coca-Cola", descripcion: "Bebida gaseosa 1.5L", precio: 1200, stock: 10, imagen: "https://static.openfoodfacts.org/images/products/544/900/013/1803/front_es.17.full.jpg" },
            { id: 2, nombre: "Pepsi", descripcion: "Bebida gaseosa 1.5L", precio: 1100, stock: 8, imagen: "https://static.openfoodfacts.org/images/products/544/900/000/0996/front_es.10.full.jpg" },
            { id: 3, nombre: "Fanta", descripcion: "Bebida naranja 1.5L", precio: 1150, stock: 7, imagen: "https://static.openfoodfacts.org/images/products/544/900/000/0997/front_es.10.full.jpg" },
            { id: 4, nombre: "Sprite", descripcion: "Bebida lima-lim√≥n 1.5L", precio: 1150, stock: 5, imagen: "https://static.openfoodfacts.org/images/products/544/900/000/0998/front_es.10.full.jpg" },
            { id: 5, nombre: "Fernet Branca", descripcion: "Bebida alcoholica 1L", precio: 10000, stock: 3, imagen: "https://images.samsung.com/is/image/samsung/p6pim/ar/sm-a145mzkgaro/gallery/ar-galaxy-a14-sm-a145-sm-a145mzkgaro-thumb-535978049" },
            { id: 6, nombre: "Heineken", descripcion: "Bebida alcoholica 700ML", precio: 4000, stock: 6, imagen: "https://www.jbl.com.ar/on/demandware.static/-/Sites-masterCatalog_Harman/default/dw2b2e2b2e/JBL_TUNE510BT_ProductImage_Hero_Black.png" },
            { id: 7, nombre: "Agua Mineral", descripcion: "Bebida 2L", precio: 5000, stock: 12, imagen: "https://resource.logitech.com/w_800,c_limit,q_auto,f_auto,dpr_1.0/d_transparent.gif/content/dam/logitech/en/products/mice/m185/gallery/m185-grey-gallery-1.png" },
            { id: 8, nombre: "Quilmes", descripcion: "Bebida alcoholica 1.5L", precio: 1500, stock: 4, imagen: "https://www.redragon.es/imagenes/teclados/kumara-k552rgb-1.jpg" },
            { id: 9, nombre: "Gaseosa Manaos", descripcion: "Cola 2.25L", precio: 1300, stock: 15, imagen: "https://static.openfoodfacts.org/images/products/779/814/025/0030/front_es.3.full.jpg" },
            { id: 10, nombre: "Mirinda", descripcion: "Bebida gaseosa 2L", precio: 1500, stock: 20, imagen: "https://images.fravega.com/f500/1b0b7c3e7e6e8e3e7e6e8e3e7e6e8e3e.jpg" }
        ];

        let carrito = [];

        function actualizarContadorCarrito() {
            document.getElementById('contadorCarrito').innerText = carrito.reduce((a, i) => a + i.cantidad, 0);
        }

        function mostrarCatalogo() {
            document.getElementById('vistaCatalogo').style.display = '';
            document.getElementById('vistaCarrito').style.display = 'none';
            document.getElementById('vistaConfirmacion').style.display = 'none';
            renderCatalogo();
        }

        function renderCatalogo(filtro = "") {
            let html = `<div class="productos">`;
            let filtrados = productos.filter(p => p.nombre.toLowerCase().includes(filtro.toLowerCase()));
            if (filtrados.length === 0) html += "<p>No se encontraron productos.</p>";
            filtrados.forEach(p => {
                html += `
                <div class="producto">
                    <img src="${p.imagen}" alt="${p.nombre}">
                    <h3>${p.nombre}</h3>
                    <div>${p.descripcion}</div>
                    <div class="precio">$${p.precio}</div>
                    <div class="stock">Stock: ${p.stock}</div>
                    <button onclick="agregarAlCarrito(${p.id})" ${p.stock === 0 ? "disabled" : ""}>Agregar al carrito</button>
                </div>`;
            });
            html += `</div>`;
            document.getElementById('vistaCatalogo').innerHTML = html;
        }

        function filtrarProductos() {
            const filtro = document.getElementById('buscador').value;
            renderCatalogo(filtro);
        }

        function agregarAlCarrito(id) {
            const prod = productos.find(p => p.id === id);
            if (!prod || prod.stock === 0) return;
            let item = carrito.find(i => i.id === id);
            if (item) {
                if (item.cantidad < prod.stock) item.cantidad++;
            } else {
                carrito.push({ ...prod, cantidad: 1 });
            }
            actualizarContadorCarrito();
            alert("¬°Producto a√±adido al carrito!");
        }

        function mostrarCarrito() {
            document.getElementById('vistaCatalogo').style.display = 'none';
            document.getElementById('vistaCarrito').style.display = '';
            document.getElementById('vistaConfirmacion').style.display = 'none';
            renderCarrito();
        }

        function renderCarrito() {
            if (carrito.length === 0) {
                document.getElementById('vistaCarrito').innerHTML = `<p>El carrito est√° vac√≠o.</p>
                <span class="volver" onclick="mostrarCatalogo()">‚Üê Volver al cat√°logo</span>`;
                return;
            }
            let total = carrito.reduce((a, i) => a + i.precio * i.cantidad, 0);
            let html = `<h2>Carrito de compras</h2>
            <table>
                <tr><th>Producto</th><th>Unidades</th><th>Precio</th><th>Importe</th><th>Acciones</th></tr>`;
            carrito.forEach((item, idx) => {
                html += `<tr>
                    <td>${item.nombre}</td>
                    <td>${item.cantidad}</td>
                    <td>$${item.precio}</td>
                    <td>$${item.precio * item.cantidad}</td>
                    <td class="acciones-carrito">
                        <button onclick="cambiarCantidad(${item.id},1)">+</button>
                        <button onclick="cambiarCantidad(${item.id},-1)">-</button>
                        <button onclick="eliminarDelCarrito(${item.id})">Eliminar</button>
                    </td>
                </tr>`;
            });
            html += `</table>
            <div class="resumen"><b>Total: $${total}</b></div>
            <button onclick="vaciarCarrito()">Vaciar carrito</button>
            <button onclick="mostrarConfirmacion()">Confirmar compra</button>
            <span class="volver" onclick="mostrarCatalogo()">‚Üê Volver al cat√°logo</span>`;
            document.getElementById('vistaCarrito').innerHTML = html;
        }

        function cambiarCantidad(id, delta) {
            let item = carrito.find(i => i.id === id);
            let prod = productos.find(p => p.id === id);
            if (!item || !prod) return;
            if (delta === 1 && item.cantidad < prod.stock) item.cantidad++;
            if (delta === -1 && item.cantidad > 1) item.cantidad--;
            actualizarContadorCarrito();
            renderCarrito();
        }

        function eliminarDelCarrito(id) {
            carrito = carrito.filter(i => i.id !== id);
            actualizarContadorCarrito();
            renderCarrito();
        }

        function vaciarCarrito() {
            carrito = [];
            actualizarContadorCarrito();
            renderCarrito();
        }

        function mostrarConfirmacion() {
            document.getElementById('vistaCatalogo').style.display = 'none';
            document.getElementById('vistaCarrito').style.display = 'none';
            document.getElementById('vistaConfirmacion').style.display = '';
            renderConfirmacion();
        }

        function renderConfirmacion() {
            let total = carrito.reduce((a, i) => a + i.precio * i.cantidad, 0);
            let totalItems = carrito.reduce((a, i) => a + i.cantidad, 0);
            let html = `<h2>Confirmaci√≥n de compra</h2>
            <div class="resumen">Total de √≠tems: <b>${totalItems}</b> | Importe total: <b>$${total}</b></div>
            <form class="formulario" onsubmit="return confirmarCompra(event)">
                <label>Nombre: <input type="text" id="nombre" required></label>
                <label>Apellido: <input type="text" id="apellido" required></label>
                <label>Email: <input type="email" id="email" required></label>
                <button type="submit">Confirmar</button>
            </form>
            <span class="volver" onclick="mostrarCarrito()">‚Üê Volver al carrito</span>`;
            document.getElementById('vistaConfirmacion').innerHTML = html;
        }

        function confirmarCompra(event) {
            event.preventDefault();
            
            alert("¬°Compra confirmada!\nGracias por tu compra, " + document.getElementById('nombre').value + "!");
            carrito = [];
            actualizarContadorCarrito();
            mostrarCatalogo();
            return false;
        }

        // Inicializar
        mostrarCatalogo();
        actualizarContadorCarrito();
    </script>
</body>
</html>