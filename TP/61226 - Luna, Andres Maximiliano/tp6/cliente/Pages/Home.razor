@page "/"
@using cliente.Services
@using cliente.Models
@inject ApiService ApiService

<PageTitle>Productos</PageTitle>


<div class= "row">
    @if (productos != null && productos.Any()){
        @foreach (var producto in productos){
            <div class= "col-md-4 mb-4">
                <div class= "card">
                <img src= @producto.ImagenUrl"
                class= "card-img-top"/>
                <div class= "card-body">
                    <h5 class= "card-title">@producto.Nombre</h5>
                    <p class= "card-text">$@producto.Precio</p>
                </div>
            </div>
            </div>
        }
    }
</div>>


@code {
    private DatosRespuesta datos;
    private string error;
    private bool cargando = false;

    private async Task ObtenerDatosDelServidor() {
        try {
            cargando = true;
            error = null;
            datos = await ApiService.ObtenerDatosAsync();
        } catch (Exception ex) {
            error = ex.Message;
            datos = null;
        } finally {
            cargando = false;
        }
    }

    private List<Producto> productos = new();

        protected override async Task OnInitializedAsync() {
            productos = await ApiService.ObtenerProductosAsync();
}
}
