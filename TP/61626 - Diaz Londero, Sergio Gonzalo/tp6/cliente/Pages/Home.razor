@page "/"
@using cliente.Services
@inject ApiService ApiService

<PageTitle>Inicio</PageTitle>

<div class="container">
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">NextGen</a>

      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Home</a>
          </li>
        </ul>

        <form class="d-flex" role="search">
          <input
            class="form-control me-2"
            type="search"
            placeholder="Search"
            aria-label="Search"
          />
          <button class="btn btn-outline-primary" type="submit">Buscar</button>
        </form>
      </div>
    </div>
  </nav>

  <div class="row my-4 row-gap-4">
    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/catHombre/zapatilla2.jpg" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>

    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/catHombre/pantalon.jpg" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>

    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/catHombre/buzo.jpg" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/catHombre/remera.jpg" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/catHombre/zapatilla.jpg" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/catHombre/short.jpg" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/catHombre/remera2.jpg" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/catHombre/botin2.jpg" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/remera1.webp" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>
    <div class="col-4">
      <div class="card" style="width: 18rem;">
        <img src="https://nextgen-grupo2.netlify.app/img/remera3.webp" class="card-img-top" alt="..." />
        <div class="card-body">
          <h5 class="card-title">Card title</h5>
          <p class="card-text">
            Some quick example text to build on the card title and make up the bulk
            of the card’s content.
          </p>
          <a href="#" class="btn btn-primary">Agregar al carrito</a>
        </div>
      </div>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-12">
      <h1>Comunicación Cliente-servidor</h1>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-12">
      <button class="btn btn-primary" @onclick="ObtenerDatosDelServidor">
        Obtener datos del servidor
      </button>
    </div>
  </div>

  <div class="row">
    <div class="col-12">
      @if (cargando)
      {
        <div class="alert alert-info">Cargando datos...</div>
      }
      else if (datos != null)
      {
        <div class="card" style="width: 300px;">
          <div class="card-header">Respuesta del servidor</div>
          <div class="card-body">
            <h5 class="card-title">@datos.Mensaje</h5>
            <p class="card-text">Fecha: @datos.Fecha.ToString("dd/MM/yyyy HH:mm:ss")</p>
          </div>
        </div>
      }
      else if (error != null)
      {
        <div class="alert alert-danger">Error: @error</div>
      }
    </div>
  </div>
</div>

@code {
  private DatosRespuesta datos;
  private string error;
  private bool cargando = false;

  private async Task ObtenerDatosDelServidor()
  {
    try
    {
      cargando = true;
      error = null;
      datos = await ApiService.ObtenerDatosAsync();
    }
    catch (Exception ex)
    {
      error = ex.Message;
      datos = null;
    }
    finally
    {
      cargando = false;
    }
  }
}
