@page "/carrito"
@using cliente.Dtos
@using cliente.Services
@inject CarritoService CarritoService

@inject CarritoService CarritoService

<h3>Carrito de Compras</h3>

@if (carrito.Count == 0)
{
    <p>No hay productos en el carrito.</p>
}
else
{
    <ul class="list-group">
        @foreach (var item in carrito)
        {
            <li class="list-group-item d-flex justify-content-between">
                <span>@item.Nombre</span>
                <span>$@item.Precio</span>
            </li>
        }
    </ul>

    <div class="mt-3">
        <label for="nombreCliente">Tu nombre:</label>
        <input id="nombreCliente" @bind="nombreCliente" class="form-control" />
        <button class="btn btn-success mt-2" @onclick="Confirmar">Confirmar compra</button>
    </div>
}

@code {
    string nombreCliente = "";
    List<ProductoDto> carrito => CarritoService.ObtenerCarrito();

    async Task Confirmar()
    {
        if (!string.IsNullOrWhiteSpace(nombreCliente))
        {
            await CarritoService.ConfirmarCompra(nombreCliente);
            nombreCliente = "";
        }
    }
}
